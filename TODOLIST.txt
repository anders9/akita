  join on...
  case ... when... then...
  functions....
  